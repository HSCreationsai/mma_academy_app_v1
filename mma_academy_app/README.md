# Indonesia MMA Youth Excellence Academy & National Coach Training Program - Streamlit App

This application serves as an intelligent assistant and training portal for MMA coaches and certified athletes associated with the Indonesia MMA Youth Excellence Academy & National Coach Training Program.

## Features

*   **Invite-Only Login:** Secure email-token based authentication.
*   **Dashboard:** Personalized welcome and (placeholder) progress summary.
*   **Video Center:** Stream admin-curated training videos.
*   **Manual Reader:** Read the comprehensive 300+ page PDF training manual page by page, with Text-to-Speech (TTS) support.
*   **RAG Chatbot:** Interact with an AI agent powered by a local LLM (e.g., Deepseek 7B) that uses the training manual as its knowledge base.
*   **Community Wall:** Internal discussion forum for members.
*   **Admin Panel:** For administrators to manage video content, upload PDF resources, and manage user invites.
*   **Model Switcher (Conceptual):** UI placeholder for future LLM model switching.
*   **Stripe Integration (Conceptual):** UI placeholder for future donation/payment checkout.

## Project Structure

```
mma_academy_app/
├── .streamlit/
│   └── secrets.toml      # Configuration for admin, SMTP, Disqus, LLM path
├── assets/
│   ├── logo.png            # Application logo
│   └── manual_draft.pdf    # The main PDF training manual (user to ensure this is the correct, complete version)
│   └── uploads/            # Directory for admin-uploaded PDF resources
│   └── temp_audio/         # Temporary storage for TTS audio files
├── data/
│   └── manual.json         # JSON version of the manual (generated by pdf_to_json.py)
├── pages/
│   ├── 1_Login.py
│   ├── 2_Dashboard.py
│   ├── 3_Video_Center.py
│   ├── 4_Chatbot.py
│   ├── 5_Community.py
│   ├── 6_Admin_Panel.py
│   └── 7_Manual_Reader.py
├── utils/
│   ├── auth.py             # Authentication logic
│   ├── db_utils.py         # SQLite database interaction utilities
│   ├── rag_agent.py        # RAG Chatbot logic (embeddings, FAISS, LLM pipeline)
│   └── pdf_to_json.py      # Script to convert manual_draft.pdf to manual.json
├── app.py                  # Main Streamlit application entry point
├── requirements.txt        # Python dependencies
├── README.md               # This file
└── mma_academy.db          # SQLite database file (will be created on first run)
```

## Setup and Installation (Windows with PyCharm & Python 3.12.6)

1.  **Prerequisites:**
    *   Python 3.12.6 (or a compatible 3.9+ version). Ensure it's added to your system PATH.
    *   PyCharm IDE (Community or Professional).
    *   Git (optional, for version control).

2.  **Download and Extract:**
    *   Download the `mma_academy_app.zip` file.
    *   Extract the contents to a desired location on your computer (e.g., `C:/Projects/`). This will create the `mma_academy_app` folder.

3.  **Open in PyCharm:**
    *   Open PyCharm.
    *   Click on "Open" and navigate to the extracted `mma_academy_app` folder. Select it and click "OK".

4.  **Create a Virtual Environment (Recommended):**
    *   Once the project is open, PyCharm might prompt you to create a virtual environment. If not, go to `File > Settings > Project: mma_academy_app > Python Interpreter`.
    *   Click the gear icon and select "Add...".
    *   Choose "Virtualenv environment". Select a location (usually within the project folder, e.g., `.venv`) and the base interpreter (your Python 3.12.6 installation).
    *   Click "OK".

5.  **Install Dependencies:**
    *   Open the Terminal in PyCharm (`View > Tool Windows > Terminal`).
    *   Ensure your virtual environment is activated. You should see `(.venv)` or similar at the start of the prompt.
    *   Run the following command to install the required Python packages:
        ```bash
        pip install -r requirements.txt
        ```
        *Note: If you encounter issues with `torch` or `faiss-cpu` on Windows, you might need to consult their official installation guides for specific Windows wheels or alternative installation methods (e.g., using Conda for PyTorch if preferred).* 
        *For `faiss-cpu`, ensure you have Microsoft Visual C++ Redistributable installed.*

6.  **Configure `secrets.toml`:**
    *   Navigate to the `.streamlit/secrets.toml` file within the project.
    *   Update the following sections as needed:
        *   `[admin] email`: Set the primary admin email address.
        *   `[smtp]`: Configure your SMTP server details (host, port, user, password) if you want the email-based access code system to send emails. For Gmail, you might need to generate an "App Password".
        *   `[disqus] shortname`: If you plan to use Disqus for the community wall (instead of the built-in one), set your Disqus shortname here. The default is `mma-academy-forum`.
        *   `[llm] model_path`: **Crucial for the Chatbot.** Set the **absolute path** to your locally downloaded LLM model directory (e.g., `D:/models/deepseek-7b` or `C:/Users/YourUser/LLM_Models/deepseek-7b`). The RAG agent is configured to use this path.

7.  **Prepare the Training Manual:**
    *   Ensure the main training manual PDF (e.g., `complete_manual complete 07.052025.pdf` provided to the AI) is copied into the `mma_academy_app/assets/` directory and **renamed to `manual_draft.pdf`**.
    *   To populate the `data/manual.json` file, which is used by the Manual Reader and Chatbot, run the conversion script from the PyCharm terminal (ensure your virtual environment is active):
        ```bash
        python utils/pdf_to_json.py
        ```
        This script will read `assets/manual_draft.pdf` and create `data/manual.json`. This step is crucial for the RAG chatbot and manual reader to function correctly.
        *If `PyPDF2` was not installed correctly during `pip install -r requirements.txt`, this script will fail. Ensure all dependencies are met.* 

8.  **Initialize Database:**
    *   The SQLite database (`mma_academy.db`) and its tables will be created automatically when you first run the application or certain utility scripts (like `db_utils.py` if run directly, or `auth.py` during login attempts).
    *   You can also initialize it manually by running from the terminal:
        ```bash
        python utils/db_utils.py
        ```

## Running the Application

1.  **Open the Terminal in PyCharm.**
2.  Ensure your virtual environment is activated.
3.  Navigate to the root of the project directory (`mma_academy_app`) if you are not already there.
4.  Run the Streamlit application using the following command:
    ```bash
    streamlit run app.py
    ```
5.  Streamlit will typically open the application automatically in your default web browser (e.g., at `http://localhost:8501`).
6.  The first time you access it, you will be directed to the Login page. Use the "Request Access Code" feature with your admin email (or an invited email) to get started.

## Notes

*   **LLM Models:** This application is designed to use local LLM models. You are responsible for downloading and providing the correct path to a compatible model (e.g., from Hugging Face). The default configuration points to a placeholder path for Deepseek 7B.
*   **Email Delivery:** For access code emails to work, the SMTP settings in `secrets.toml` must be correctly configured with a valid email provider that allows SMTP access.
*   **Stripe Integration:** The Stripe payment integration is a UI placeholder only. No actual payment processing is implemented. You would need to add your Stripe keys and backend logic if you wish to enable this feature.
*   **Troubleshooting:**
    *   If `ModuleNotFoundError` occurs, ensure all packages in `requirements.txt` are installed in your active virtual environment.
    *   If the chatbot or manual reader doesn't load content, verify that `assets/manual_draft.pdf` exists and `python utils/pdf_to_json.py` was run successfully to create `data/manual.json`.
    *   Check the PyCharm terminal and browser console for any error messages.

Enjoy using the Indonesia MMA Academy Portal!

